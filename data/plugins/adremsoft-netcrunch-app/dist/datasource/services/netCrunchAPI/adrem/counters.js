'use strict';System.register([],function(_export){'use strict';var C_PERSEC,CNT_SEPARATOR,CNT_SRC_SEPARATOR,MIB_CNT_SRC_ID,XML_CNT_SRC_ID,OVERALL_TOTAL,OVERALL_MAXIMUM,OVERALL_MINIMUM,OVERALL_AVERAGE,OVERALL_COUNT,knownMSCounters,NETCRUNCH_COUNTER_CONST,NETCRUNCH_COUNTER_TYPES;function NetCrunchCounters(a,b){var _this=this;function d(X){return 0<=X.indexOf(C_PERSEC)&&(X=X.replace(C_PERSEC,'')),null!=X.match(/^((([0-9]+)\.)+[0-9]+)$/)}function g(X){return X===MIB_CNT_SRC_ID?W.CNT_TYPE.cstMIB:W.CNT_TYPE.cstXML}function h(X){var Y=void 0;return Y=W.CNT_TYPE.cstSimple,0<X.indexOf(CNT_SRC_SEPARATOR)&&(Y=g(X.split(CNT_SRC_SEPARATOR)[0])),Y}function j(X){var Y=X;return 0<X.indexOf(CNT_SRC_SEPARATOR)&&(Y=X.split(CNT_SRC_SEPARATOR)[1]),Y}function l(X){var Y=void 0,Z=void 0,$=void 0;return 0>X.indexOf(CNT_SRC_SEPARATOR)?(Y=W.CNT_TYPE.cstXML,Z=X):($=X.split(CNT_SRC_SEPARATOR),Y=g($[0]),Z=$[1]),{type:Y,value:Z}}function n(X){var Y={},Z=W.SNMP_FUNC.scfUnknown;return Y[OVERALL_TOTAL]=W.SNMP_FUNC.scfSum,Y[OVERALL_AVERAGE]=W.SNMP_FUNC.scfAvg,Y[OVERALL_MAXIMUM]=W.SNMP_FUNC.scfMax,Y[OVERALL_MINIMUM]=W.SNMP_FUNC.scfMin,Y[OVERALL_COUNT]=W.SNMP_FUNC.scfCount,null!=Y[X]&&(Z=Y[X]),Z}function o(X){// eslint-disable-next-line
return z(X)}function q(X){var Y=o(X),Z=Y.obj,$=Y.cnt,_=Y.inst,aa=void 0,ba=0<=$.indexOf(C_PERSEC),//eslint-disable-line
ca=void 0;return!0==ba&&($=$.replace(C_PERSEC,'')),''===_||'-'===_?(ca=$.match(/(.*)\.([0-9]+)$/),1<ca.length&&($=ca[1],_=ca[2]),aa='0'===_?W.SNMP_INSTANCE_TYPE.sitNone:W.SNMP_INSTANCE_TYPE.sitByIndex):'#'===_.charAt(0)?(_=_.substr(1),aa=W.SNMP_INSTANCE_TYPE.sitByIndex):'_'===_.charAt(0)&&n(_)!==W.SNMP_FUNC.scfUnknown?aa=W.SNMP_INSTANCE_TYPE.sitComputable:aa=W.SNMP_INSTANCE_TYPE.sitByLookup,{objOID:$,instOID:Z,inst:_,isPerSec:ba,type:aa}}function r(X,Y){var Z=o(X),$=Z.inst,_=void 0;return!0===Y&&(_=W.SNMP_INSTANCE_TYPE.sitByLookup,''===$?''===$||'-'===$?_=W.SNMP_INSTANCE_TYPE.sitNone:_=W.SNMP_INSTANCE_TYPE.sitByLookup:'#'===$.charAt(0)?($=$.substr(1),_=W.SNMP_INSTANCE_TYPE.sitByIndex):'_'===$.charAt(0)&&(_=W.SNMP_INSTANCE_TYPE.sitComputable),Z.inst=$,Z.type=_),Z}function u(X,Y,Z){var $=!1;return new Promise(function(_){null==Y[X]?(Y[X]=X,$=!0):Y[X]===X&&($=!0),!0==$?Z({oid:X},function(aa){Y[X]=aa,_(aa)}):_(Y[X])})}function w(){null==P&&(P=new a.NetCrunch.SnmpMibData('ncSrv',function(){},b))}function x(X){return w(),u(X,Q,P.getShortOidPath)}function y(X){return w(),u(X,R,P.getFullOidPath)}function z(X){var Y=X.split(CNT_SEPARATOR),Z={};return Z.obj=Y[0],Z.cnt=1<Y.length?Y[1]:'',Z.inst=3===Y.length?Y[2]:3<Y.length?Y.slice(2).join(CNT_SEPARATOR):'',Z}function D(X,Y){var Z=X.obj,$=void 0;return Y=null==Y||Y,''!==X.inst&&null!=X.inst&&(Z=X.obj+'('+X.inst+')'),''!==X.cnt&&null!=X.cnt&&(!Y&&X.perSec?($=X.cnt.indexOf(C_PERSEC),Z=Z+'\\'+X.cnt.substr(0,$)):Z=Z+'\\'+X.cnt),Z}function E(X){var Y=z(X);return D(Y,!0)}function F(X,Y,Z){return''===Z?X+CNT_SEPARATOR+Y:X+CNT_SEPARATOR+Y+CNT_SEPARATOR+Z}function G(X,Y,Z){var $=l(X),_=void 0,aa=Promise.resolve(null);if($.type===W.CNT_TYPE.cstXML)aa=Promise.resolve(E($.value));else if($.type===W.CNT_TYPE.cstMIB)return _=q(X),aa=!0===Y?x(_.objOID):y(_.objOID),aa.then(function(ba){return(null==ba||''===ba)&&(ba=_.objOID),'0'===_.inst&&(_.inst=''),ba=E(F(ba,'',_.inst)),!0===Z&&!0===_.isPerSec&&(ba+=C_PERSEC),ba});return aa}function I(X){return 0<=knownMSCounters.indexOf(X.toLowerCase())}/**
   * isMillisecondsCounter(
   * @param counter
   * @returns {boolean}
   */function J(X){var Y=z(X);return Y.cnt===T||Y.cnt===S||0<=Y.cnt.toUpperCase().indexOf('MILLISECOND')||I(Y.cnt)}function K(X,Y){return 0<=X.indexOf(Y)}/**
   * isBytesCounter
   * @param displayName
   * @returns {null|''|'M'|'K'}
   */function L(X){var Y=X.toLowerCase(),Z='';return K(Y,U.metrics.bytes)||K(Y,U.metrics.memory)||K(Y,'octet')?(K(Y,U.metrics.mbytes)||K(Y,'mega')?Z='M':(K(Y,U.metrics.kbytes)||K(Y,'kilo'))&&(Z='K'),Z):null}function M(X,Y,Z){var $=3<arguments.length&&void 0!==arguments[3]?arguments[3]:['K','M','G'],_='';return X>=1*Y&&X<Y*Z?(X/=Y,_=$[0]):X>=Y*Z&&X<Y*Z*Z?(X=X/Y/Z,_=$[1]):X>=Y*Z*Z&&(X=X/Y/Z/Z,_=$[2]),{value:X,units:_}}function N(X,Y){return M(X,Y,Y)}function O(X){return M(X,1e3,60,['sec','min','hrs'])}var P=null,Q=Object.create(null),R=Object.create(null),S='Check Time',T='Round Trip Time',U=Object.create(null),V=NETCRUNCH_COUNTER_TYPES,W=NETCRUNCH_COUNTER_CONST;return{unitsToMetric:function(X,Y,Z){if('bytestobps'===X)return'bps';return'percentage'===X?'%':'bytesps'===X?'Bps':'bytes'===X?'bytes':_this.getMetric(Y,Z)},/**
     * Get Metric for Counter
     * @param counterPath
     * @param displayName
     * @returns {*}
     */getMetric:function(X,Y){var Z=void 0;if(K(Y,'%'))return V.percentage;return J(X)?V.milliseconds:(Z=L(Y),null===Z?'':(''!==Z&&(Z='\'#'+Z),K(Y,C_PERSEC)||K(Y,'per sec.')?V.bytesBitsPS+Z:V.bytes+Z))},getDisplayValue:function(X,Y){var Z=Y.split('#'),$=Z[0],_=1<Z.length?Z[1]:'',aa=$===V.bytesBitsPS,ba=$===V.bytes||aa||$===V.bytesBps,ca=$===V.milliseconds,ea=void 0;return null==X||isNaN(X)?{value:X,units:''}:(aa&&(X*=8),''!==_)?{value:Math.round(100*X)/100,units:_+(ba?'B':'')}:(ba?(ea=N(X,1024),ea.units+=$===V.bytes?'B':$):''===$?ea=N(X,1e3):ca?(ea=O(X),''===ea.units&&(ea.units=V.milliseconds)):ea={value:X,units:$},{value:ea.value,units:ea.units})},isOid:d,isMIBCnt:function(X,Y){return!0===d(X)&&(''===Y||!0===d(Y))||''===X&&!0===d(Y)},counterPathObject:function(X,Y){if(Y!==W.CNT_TYPE.cstSimple){if(Y===W.CNT_TYPE.cstXML)return XML_CNT_SRC_ID+CNT_SRC_SEPARATOR+X;if(Y===W.CNT_TYPE.cstMIB)return MIB_CNT_SRC_ID+CNT_SRC_SEPARATOR+X}return X},stringToCntType:g,getCounterPathType:h,removeCounterPathType:j,removePerSecond:function(X){return X.replace(C_PERSEC,'')},parseSNMPPath:l,parseOIDPath:q,parseXMLPath:r,parseCounterPath:function(X){var Y=h(X),Z=void 0;return Y===W.CNT_TYPE.cstXML?Z=r(X,!0):Y===W.CNT_TYPE.cstMIB?(Z=q(j(X)),Z.obj=Z.objOID,Z.cnt='',''===Z.inst&&(Z.inst=Z.instOID)):Y===W.CNT_TYPE.cstSimple&&(Z=o(X)),Z},getShortOidPath:x,getFullOidPath:y,decodePath:z,encodePath:function(X){var Y=[X.obj,X.cnt];return''!==X.inst&&Y.push(X.inst),Y.join(CNT_SEPARATOR)},addInstance:function(X,Y){return''===Y?X:X+CNT_SEPARATOR+Y},decodeDisplayPath:function(X){var Y={obj:'',cnt:'',inst:''},Z=X.indexOf(C_PERSEC),$=0<=Z,_=void 0;return $&&(X=X.substr(0,Z)),[{fmt:/(.+)\((.+)\)\\(.+)/,parts:['obj','inst','cnt']},// obj(inst)\cnt
{fmt:/(.+)\((.+)\)/,parts:['obj','inst']},// obj(inst)
{fmt:/(.+)\\(.+)/,parts:['obj','cnt']// obj\cnt
}].some(function(aa){//eslint-disable-line
var ba=X.match(aa.fmt);return null!=ba&&(aa.parts.forEach(function(ca,da){Y[ca]=ba[da+1]}),!0)})||(Y.obj=X),''===Y.cnt&&''!==Y.obj&&(Y.obj.match('^[0-9\\.]+(\\.[0-9]+)$')?(Y.cnt='',''!==Y.inst&&(Y.obj=Y.obj+'.'+Y.inst,Y.inst='')):0<=Y.obj.indexOf('.')?(_=Y.obj.split('.'),Y.cnt=_[1],Y.obj=_[0]):(Y.cnt=Y.obj,Y.obj='')),Y.perSec=$,$&&(Y.cnt+=C_PERSEC),Y},encodeDisplayPath:D,removePerSec:function(X){var Y=X.indexOf(C_PERSEC);// todo: check if ix == displayName.length - C_PERSEC.length
return X.substr(0,Y)},getSNMPDisplayPath:G,counterPathToDisplayStr:function(X,Y,Z){var $=h(X);return $===W.CNT_TYPE.cstXML||$===W.CNT_TYPE.cstMIB?G(X,Y,Z):Promise.resolve(E(X))}}}return{setters:[],execute:function(){C_PERSEC='/sec';CNT_SEPARATOR='|';CNT_SRC_SEPARATOR='&';MIB_CNT_SRC_ID='MIB';XML_CNT_SRC_ID='XML';OVERALL_TOTAL='_Total';OVERALL_MAXIMUM='_Maximum';OVERALL_MINIMUM='_Minimum';OVERALL_AVERAGE='_Average';OVERALL_COUNT='_Count';knownMSCounters=['load time','check time','round trip time'];_export('NETCRUNCH_COUNTER_CONST',NETCRUNCH_COUNTER_CONST={CNT_TYPE:{cstXML:1,cstMIB:2,cstSimple:3},SNMP_INSTANCE_TYPE:{sitValue:1,sitNone:2,sitByIndex:3,sitByLookup:4,sitComputable:5},SNMP_FUNC:{scfUnknown:1,scfSum:2,scfMin:3,scfMax:4,scfAvg:5,scfCount:6}});_export('NETCRUNCH_COUNTER_TYPES',NETCRUNCH_COUNTER_TYPES={percentage:'%',milliseconds:'ms',bytesBitsPS:'bps',bytesBps:'Bps',bytes:'bytes'});_export('NETCRUNCH_COUNTER_CONST',NETCRUNCH_COUNTER_CONST);_export('NETCRUNCH_COUNTER_TYPES',NETCRUNCH_COUNTER_TYPES);_export('NetCrunchCounters',NetCrunchCounters)}}});
//# sourceMappingURL=counters.js.map
