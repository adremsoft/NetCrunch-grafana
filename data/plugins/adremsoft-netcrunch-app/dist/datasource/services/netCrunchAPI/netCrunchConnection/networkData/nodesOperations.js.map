{"version":3,"sources":["../../../../../../src/datasource/services/netCrunchAPI/netCrunchConnection/networkData/nodesOperations.js"],"names":["sortNodesByNameAndAddress","nodes","compareAddressIP","addressOne","addressTwo","addressOneItems","split","addressTwoItems","i","n","Math","max","length","getNodeProperty","node","propertyName","filter","id","name","address","sort","nodeA","nodeB","nodeAName","toLowerCase","nodeBName","nodeAAddress","nodeBAddress","result","localeCompare","getWebWorker","workerBuilder","AdremWebWorker","webWorkerBuilder","addFunctionCode","webWorkerSingleton","THREAD_WORKER_NODES_NUMBER","NetCrunchNodesOperations","Promise","resolve","nodesRemoteBuffer","forEach","index","push","then","sortedNodes","deviceTypePattern","checkDeviceType"],"mappings":"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","file":"nodesOperations.js","sourcesContent":["/**\r\n * @license\r\n * Copyright AdRem Software. All Rights Reserved.\r\n *\r\n * Use of this source code is governed by an Apache License, Version 2.0 that can be\r\n * found in the LICENSE file.\r\n */\r\n\r\nimport { AdremWebWorker } from '../../adrem/module';\r\n\r\nconst THREAD_WORKER_NODES_NUMBER = 1000;\r\n\r\nlet webWorkerSingleton = null;\r\n\r\nfunction sortNodesByNameAndAddress(nodes) {\r\n\r\n  function compareAddressIP(addressOne, addressTwo) {\r\n    const\r\n      addressOneItems = addressOne.split('.'),\r\n      addressTwoItems = addressTwo.split('.');\r\n\r\n    for (let i = 0, n = Math.max(addressOneItems.length, addressTwoItems.length); i < n; i += 1) {\r\n      if (addressOneItems[i] !== addressTwoItems[i]) {\r\n        return (addressOneItems[i] < addressTwoItems[i]) ? -1 : 1;\r\n      }\r\n    }\r\n    return 0;\r\n  }\r\n\r\n  function getNodeProperty(node, propertyName) {\r\n    return ((node != null) && (node[propertyName] != null)) ? node[propertyName] : '';\r\n  }\r\n\r\n  function compareNodeData(nodeA, nodeB) {\r\n    const\r\n      nodeAName = getNodeProperty(nodeA, 'name').toLowerCase(),\r\n      nodeBName = getNodeProperty(nodeB, 'name').toLowerCase(),\r\n      nodeAAddress = getNodeProperty(nodeA, 'address'),\r\n      nodeBAddress = getNodeProperty(nodeB, 'address');\r\n    let result = 0;\r\n\r\n    if ((nodeAName !== '') && (nodeBName !== '')) {\r\n      result = nodeAName.localeCompare(nodeBName);\r\n    } else if ((nodeAName === '') && (nodeBName === '')) {\r\n      result = compareAddressIP(nodeAAddress, nodeBAddress);\r\n    } else {\r\n      if (nodeAName !== '') { result = -1; }\r\n      if (nodeBName !== '') { result = 1; }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  return nodes\r\n    .filter(node => ((node != null) && ((node.id != null) && ((node.name != null) && (node.address != null)))))\r\n    .sort(compareNodeData);\r\n\r\n}\r\n\r\nfunction getWebWorker() {\r\n  if (webWorkerSingleton == null) {\r\n    const workerBuilder = AdremWebWorker.webWorkerBuilder();\r\n    workerBuilder.addFunctionCode(sortNodesByNameAndAddress, true);\r\n    webWorkerSingleton = workerBuilder.getWebWorker();\r\n  }\r\n  return webWorkerSingleton;\r\n}\r\n\r\nclass NetCrunchNodesOperations {\r\n\r\n  static asyncSortByNameAndAddress(nodes = []) {\r\n    return new Promise((resolve) => {\r\n      if (nodes.length < THREAD_WORKER_NODES_NUMBER) {\r\n        const result = sortNodesByNameAndAddress(nodes);\r\n        resolve(result);\r\n      } else {\r\n        const nodesRemoteBuffer = [];\r\n\r\n        nodes.forEach((node, index) => {\r\n          nodesRemoteBuffer.push({\r\n            id: node.id,\r\n            name: node.name,\r\n            address: node.address,\r\n            index\r\n          });\r\n        });\r\n\r\n        getWebWorker().sortNodesByNameAndAddress(nodesRemoteBuffer)\r\n          .then((sortedNodes) => {\r\n            const result = [];\r\n            sortedNodes.forEach(node => result.push(nodes[node.index]));\r\n            resolve(result);\r\n          });\r\n      }\r\n    });\r\n  }\r\n\r\n  static deviceTypeFilter(nodes = [], deviceTypePattern) {\r\n    return nodes.filter(node => node.checkDeviceType(deviceTypePattern));\r\n  }\r\n\r\n}\r\n\r\nexport {\r\n  NetCrunchNodesOperations\r\n};\r\n"]}