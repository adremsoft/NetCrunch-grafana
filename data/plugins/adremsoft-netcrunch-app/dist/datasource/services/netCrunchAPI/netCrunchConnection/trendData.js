'use strict';System.register(['moment'],function(_export){'use strict';var moment,NETCRUNCH_TREND_DATA_CONST;function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function asArray(a){return Array.isArray(a)?a:[a]}function NetCrunchTrendData(a){var _s;function b(x){return s[x]}function c(){var x=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,y=v.DEFAULT;if(null!=x){var z=parseInt(x,10);!isNaN(x)&&x>=v.MIN&&x<=v.MAX&&(y=z)}return y}function d(x,y){var A=void 0,B=void 0;return y=y.toUpperCase(),'MINUTES'===y?(A=x.minute()%5,B=x.subtract(A,'minutes')):('HOURS'===y?y='hour':'DAYS'===y?y='day':'MONTHS'===y&&(y='month'),B=x.startOf(y)),B.startOf('minute')}function e(x,y,z){return x=moment(x).subtract(z.periodInterval,z.periodName),y=moment(y).add(z.periodInterval,z.periodName),y>moment()&&(y=moment()),{from:d(x,z.periodName),to:y,periodInterval:z.periodInterval,periodType:z.periodType,periodName:z.periodName}}function f(x,y){var z={periodType:r.tpMinutes,periodName:b(r.tpMinutes),periodInterval:1};return e(x,y,z)}function g(x,y,z){var A=60000,B=60*A,C=24*B,D=30*C,F=[{length:A,type:r.tpMinutes,interval:1},{length:5*A,type:r.tpMinutes,interval:5},{length:10*A,type:r.tpMinutes,interval:10},{length:15*A,type:r.tpMinutes,interval:15},{length:20*A,type:r.tpMinutes,interval:20},{length:30*A,type:r.tpMinutes,interval:30},{length:B,type:r.tpHours,interval:1},{length:2*B,type:r.tpHours,interval:2},{length:3*B,type:r.tpHours,interval:3},{length:4*B,type:r.tpHours,interval:4},{length:6*B,type:r.tpHours,interval:6},{length:8*B,type:r.tpHours,interval:8},{length:C,type:r.tpDays,interval:1},{length:7*C,type:r.tpDays,interval:7},{length:D,type:r.tpMonths,interval:1},{length:3*D,type:r.tpMonths,interval:3},{length:6*D,type:r.tpMonths,interval:6},{length:9*D,type:r.tpMonths,interval:9},{length:12*D,type:r.tpMonths,interval:12},{length:15*D,type:r.tpMonths,interval:15},{length:18*D,type:r.tpMonths,interval:18},{length:21*D,type:r.tpMonths,interval:21},{length:24*D,type:r.tpMonths,interval:24}],G=0;return F.some(function(H,I){return!!(H.length*z>+(y-x))&&(G=I,!0)}),{periodType:F[G].type,periodName:b(F[G].type),periodInterval:F[G].interval}}function h(x,y,z){var A=g(x,y,z);return e(x,y,A)}function j(x){var y=void 0;return y=Object.keys(x).filter(function(z){return!0===x[z]&&null!=t[z]}),y=y.map(function(z){return t[z]}),{ResultMask:y}}function k(x,y,z,A){var B=[],C=b(y),D=void 0,E=void 0;for(x=moment(x).startOf('minute'),E=0;E<A;E+=1)D=moment(x).add(E*z,C),B.push(D.toDate());return B}function l(x,y){var z=Object.create(null),A=void 0;return y=y.ResultMask,A=u.filter(function(B){return 0<=y.indexOf(t[B])}),A.forEach(function(B){z[B]=[]}),x.trend.forEach(function(B){asArray(B).forEach(function(C,D){z[A[D]].push(C)})}),null!=x.distr&&(z.distr=x.distr),z}function n(x,y,z,A){var B=4<arguments.length&&void 0!==arguments[4]?arguments[4]:r.tpHours,C=5<arguments.length&&void 0!==arguments[5]?arguments[5]:1,D=6<arguments.length&&void 0!==arguments[6]?arguments[6]:null;return null==x||null==y?Promise.resolve(null):(D=null==D?j({avg:!0}):j(D),0===D.ResultMask.length&&(D=j({avg:!0})),a.queryTrendData(x.toString(),y,B,C,z,A,D,null,// day mask just no mask
null,// value for equal checking
null).then(function(E){// eslint-disable-line
return{domain:k(z,B,C,E.trend.length),values:l(E,D)}}))}var r=NETCRUNCH_TREND_DATA_CONST.PERIOD_TYPE,s=(_s={},_defineProperty(_s,r.tpMinutes,'minutes'),_defineProperty(_s,r.tpHours,'hours'),_defineProperty(_s,r.tpDays,'days'),_defineProperty(_s,r.tpMonths,'months'),_s),t=NETCRUNCH_TREND_DATA_CONST.QUERY_RESULT_MASKS,u=NETCRUNCH_TREND_DATA_CONST.QUERY_RESULT_ORDER,v=NETCRUNCH_TREND_DATA_CONST.MAX_SAMPLE_COUNT,w={periodInterval:2,periodName:s[r.tpDays]};return{MAX_SAMPLE_COUNT:v,prepareTimeRange:function(x,y,z){var A=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,B=null;return A=c(A),B=!0===z?moment(y).subtract(w.periodInterval,w.periodName)<=x?{result:f(x,y)}:{error:{periodInterval:w.periodInterval,periodName:w.periodName}}:{result:h(x,y,A)},B},getCounterTrendData:n,getCounterTrendRAWData:function(x,y,z,A,B){return n(x,y,z,A,r.tpMinutes,1,B)},getCounterData:function(x,y,z,A,B,C,D){var E=Object.create(null);return A=A||moment(),B=B||v.DEFAULT,D=D||g(z,A,B),E.period=D,E.data=n(x,y,z,A,D.periodType,D.periodInterval,C),E},grafanaDataConverter:function(x){return x.domain.map(function(y,z){return[x.values[z],y.getTime()]})}}}return{setters:[function(_moment){moment=_moment.default}],execute:function(){_export('NETCRUNCH_TREND_DATA_CONST',NETCRUNCH_TREND_DATA_CONST={MAX_SAMPLE_COUNT:{MIN:10,DEFAULT:200,MAX:5e3},PERIOD_TYPE:{tpMinutes:0,tpHours:1,tpDays:2,tpMonths:3},QUERY_RESULT_MASKS:{min:'tqrMin',avg:'tqrAvg',max:'tqrMax',avail:'tqrAvail',delta:'tqrDelta',equal:'tqrEqual',distr:'tqrDistr'},QUERY_RESULT_ORDER:['avg','min','max','avail','delta','equal']});_export('NETCRUNCH_TREND_DATA_CONST',NETCRUNCH_TREND_DATA_CONST);_export('NetCrunchTrendData',NetCrunchTrendData)}}});
//# sourceMappingURL=trendData.js.map
